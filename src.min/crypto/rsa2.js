function pkcs1unpad2(e,t){var n=e.toByteArray();var r=0;while(r<n.length&&n[r]==0)++r;if(n.length-r!=t-1||n[r]!=2)return null;++r;while(n[r]!=0)if(++r>=n.length)return null;var i="";while(++r<n.length){var s=n[r]&255;if(s<128){i+=String.fromCharCode(s)}else if(s>191&&s<224){i+=String.fromCharCode((s&31)<<6|n[r+1]&63);++r}else{i+=String.fromCharCode((s&15)<<12|(n[r+1]&63)<<6|n[r+2]&63);r+=2}}return i}function RSASetPrivate(e,t,n){if(e!=null&&t!=null&&e.length>0&&t.length>0){this.n=parseBigInt(e,16);this.e=parseInt(t,16);this.d=parseBigInt(n,16)}else alert("Invalid RSA private key")}function RSASetPrivateEx(e,t,n,r,i,s,o,u){if(e!=null&&t!=null&&e.length>0&&t.length>0){this.n=parseBigInt(e,16);this.e=parseInt(t,16);this.d=parseBigInt(n,16);this.p=parseBigInt(r,16);this.q=parseBigInt(i,16);this.dmp1=parseBigInt(s,16);this.dmq1=parseBigInt(o,16);this.coeff=parseBigInt(u,16)}else alert("Invalid RSA private key")}function RSAGenerate(e,t){var n=new SecureRandom;var r=e>>1;this.e=parseInt(t,16);var i=new BigInteger(t,16);for(;;){for(;;){this.p=new BigInteger(e-r,1,n);if(this.p.subtract(BigInteger.ONE).gcd(i).compareTo(BigInteger.ONE)==0&&this.p.isProbablePrime(10))break}for(;;){this.q=new BigInteger(r,1,n);if(this.q.subtract(BigInteger.ONE).gcd(i).compareTo(BigInteger.ONE)==0&&this.q.isProbablePrime(10))break}if(this.p.compareTo(this.q)<=0){var s=this.p;this.p=this.q;this.q=s}var o=this.p.subtract(BigInteger.ONE);var u=this.q.subtract(BigInteger.ONE);var a=o.multiply(u);if(a.gcd(i).compareTo(BigInteger.ONE)==0){this.n=this.p.multiply(this.q);this.d=i.modInverse(a);this.dmp1=this.d.mod(o);this.dmq1=this.d.mod(u);this.coeff=this.q.modInverse(this.p);break}}}function RSADoPrivate(e){if(this.p==null||this.q==null)return e.modPow(this.d,this.n);var t=e.mod(this.p).modPow(this.dmp1,this.p);var n=e.mod(this.q).modPow(this.dmq1,this.q);while(t.compareTo(n)<0)t=t.add(this.p);return t.subtract(n).multiply(this.coeff).mod(this.p).multiply(this.q).add(n)}function RSADecrypt(e){var t=parseBigInt(e,16);var n=this.doPrivate(t);if(n==null)return null;return pkcs1unpad2(n,this.n.bitLength()+7>>3)}RSAKey.prototype.doPrivate=RSADoPrivate;RSAKey.prototype.setPrivate=RSASetPrivate;RSAKey.prototype.setPrivateEx=RSASetPrivateEx;RSAKey.prototype.generate=RSAGenerate;RSAKey.prototype.decrypt=RSADecrypt